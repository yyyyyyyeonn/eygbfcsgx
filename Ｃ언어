#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define MAX_STUDENTS 100

typedef struct {
    int id;
    char name[50];
    int score_ko;
    int score_en;
    int score_math;
    float average;
    char grade;
} Student;

void inputStudent(Student *s) {
    printf("í•™ë²ˆ: ");
    scanf("%d", &s->id);
    printf("ì´ë¦„: ");
    scanf("%s", s->name);
    printf("êµ­ì–´ ì ìˆ˜: ");
    scanf("%d", &s->score_ko);
    printf("ì˜ì–´ ì ìˆ˜: ");
    scanf("%d", &s->score_en);
    printf("ìˆ˜í•™ ì ìˆ˜: ");
    scanf("%d", &s->score_math);

    s->average = (s->score_ko + s->score_en + s->score_math) / 3.0;

    if (s->average >= 90) s->grade = 'A';
    else if (s->average >= 80) s->grade = 'B';
    else if (s->average >= 70) s->grade = 'C';
    else if (s->average >= 60) s->grade = 'D';
    else s->grade = 'F';
}

void printStudent(const Student *s) {
    printf("\ní•™ë²ˆ: %d\n", s->id);
    printf("ì´ë¦„: %s\n", s->name);
    printf("êµ­ì–´: %d, ì˜ì–´: %d, ìˆ˜í•™: %d\n", s->score_ko, s->score_en, s->score_math);
    printf("í‰ê· : %.2f\n", s->average);
    printf("í•™ì : %c\n", s->grade);
}

void saveToFile(const Student students[], int count, const char *filename) {
    FILE *fp = fopen(filename, "w");
    if (!fp) {
        printf("íŒŒì¼ ì €ì¥ ì‹¤íŒ¨\n");
        return;
    }

    fprintf(fp, "í•™ë²ˆ,ì´ë¦„,êµ­ì–´,ì˜ì–´,ìˆ˜í•™,í‰ê· ,í•™ì \n");
    for (int i = 0; i < count; i++) {
        fprintf(fp, "%d,%s,%d,%d,%d,%.2f,%c\n",
                students[i].id,
                students[i].name,
                students[i].score_ko,
                students[i].score_en,
                students[i].score_math,
                students[i].average,
                students[i].grade);
    }

    fclose(fp);
    printf("íŒŒì¼ ì €ì¥ ì™„ë£Œ: %s\n", filename);
}

void findTopStudent(const Student students[], int count) {
    if (count == 0) {
        printf("í•™ìƒ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.\n");
        return;
    }

    int topIndex = 0;
    for (int i = 1; i < count; i++) {
        if (students[i].average > students[topIndex].average) {
            topIndex = i;
        }
    }

    printf("\nğŸ“Œ ìµœê³  ì ìˆ˜ í•™ìƒ ì •ë³´:\n");
    printStudent(&students[topIndex]);
}

int main() {
    Student students[MAX_STUDENTS];
    int n;

    printf("í•™ìƒ ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ìµœëŒ€ %dëª…): ", MAX_STUDENTS);
    scanf("%d", &n);

    if (n <= 0 || n > MAX_STUDENTS) {
        printf("ì˜ëª»ëœ í•™ìƒ ìˆ˜ì…ë‹ˆë‹¤.\n");
        return 1;
    }

    for (int i = 0; i < n; i++) {
        printf("\n[%dë²ˆì§¸ í•™ìƒ ì •ë³´ ì…ë ¥]\n", i + 1);
        inputStudent(&students[i]);
    }

    printf("\n==== ì „ì²´ í•™ìƒ ì •ë³´ ====\n");
    for (int i = 0; i < n; i++) {
        printStudent(&students[i]);
    }

    findTopStudent(students, n);
    saveToFile(students, n, "students.csv");

    return 0;
}
